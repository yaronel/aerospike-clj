<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>aerospike-clj.client documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Aerospike-clj</span> <span class="project-version">0.3.6</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="advanced-async-hooks.html"><div class="inner"><span># Advanced asynchronous hooks:</span></div></a></li><li class="depth-1 "><a href="implementing-clients.html"><div class="inner"><span># Implementing `IAerospikeClient`</span></div></a></li><li class="depth-1 "><a href="tutorial.html"><div class="inner"><span>Tutorial</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>aerospike-clj</span></div></div></li><li class="depth-2 branch current"><a href="aerospike-clj.client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></a></li><li class="depth-2 branch"><a href="aerospike-clj.metrics.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metrics</span></div></a></li><li class="depth-2 branch"><a href="aerospike-clj.policy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>policy</span></div></a></li><li class="depth-2"><a href="aerospike-clj.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="aerospike-clj.client.html#var-_get"><div class="inner"><span>_get</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-add-bins"><div class="inner"><span>add-bins</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-ClientEvents"><div class="inner"><span>ClientEvents</span></div></a></li><li class="depth-2 branch"><a href="aerospike-clj.client.html#var-on-failure"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>on-failure</span></div></a></li><li class="depth-2"><a href="aerospike-clj.client.html#var-on-success"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>on-success</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-create"><div class="inner"><span>create</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-create-client"><div class="inner"><span>create-client</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-create-event-loops"><div class="inner"><span>create-event-loops</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-delete"><div class="inner"><span>delete</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-delete-bins"><div class="inner"><span>delete-bins</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-EPOCH"><div class="inner"><span>EPOCH</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-exists.3F"><div class="inner"><span>exists?</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-expiry-unix"><div class="inner"><span>expiry-unix</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-get-batch"><div class="inner"><span>get-batch</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-get-cluster-stats"><div class="inner"><span>get-cluster-stats</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-get-multiple"><div class="inner"><span>get-multiple</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-get-single"><div class="inner"><span>get-single</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-get-single-no-meta"><div class="inner"><span>get-single-no-meta</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-healthy.3F"><div class="inner"><span>healthy?</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-IAerospikeClient"><div class="inner"><span>IAerospikeClient</span></div></a></li><li class="depth-2 branch"><a href="aerospike-clj.client.html#var-get-all-clients"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>get-all-clients</span></div></a></li><li class="depth-2"><a href="aerospike-clj.client.html#var-get-client"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>get-client</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-init-simple-aerospike-client"><div class="inner"><span>init-simple-aerospike-client</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-MAX_BIN_NAME_LENGTH"><div class="inner"><span>MAX_BIN_NAME_LENGTH</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-MAX_KEY_LENGTH"><div class="inner"><span>MAX_KEY_LENGTH</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-operate"><div class="inner"><span>operate</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-put"><div class="inner"><span>put</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-put-multiple"><div class="inner"><span>put-multiple</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-replace-only"><div class="inner"><span>replace-only</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-set-single"><div class="inner"><span>set-single</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-stop-aerospike-client"><div class="inner"><span>stop-aerospike-client</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-touch"><div class="inner"><span>touch</span></div></a></li><li class="depth-1"><a href="aerospike-clj.client.html#var-update"><div class="inner"><span>update</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">aerospike-clj.client</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-_get"><h3>_get</h3><div class="usage"><code>(_get db index set-name conf bin-names)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L189">view source</a></div></div><div class="public anchor" id="var-add-bins"><h3>add-bins</h3><div class="usage"><code>(add-bins db index set-name new-data new-expiration)</code><code>(add-bins db index set-name new-data new-expiration conf)</code></div><div class="doc"><div class="markdown"><p>Add bins to an existing record without modifying old data. The <code>new-data</code> must be a Clojure map.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L374">view source</a></div></div><div class="public anchor" id="var-ClientEvents"><h3>ClientEvents</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Continuation functions that are registered when an async DB operation is called. The DB passed is an <code>IAerospikeClient</code> instance. The value returned from those function will be the value of the returned deferred from the async operation.</p></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-on-failure"><h3>on-failure</h3><div class="usage"><code>(on-failure _ op-name op-ex index op-start-time db)</code></div><div class="doc"><div class="markdown"><p>A continuation function. Registered on the operation future and called when operations fails.</p></div></div></div><div class="public anchor" id="var-on-success"><h3>on-success</h3><div class="usage"><code>(on-success _ op-name op-result index op-start-time db)</code></div><div class="doc"><div class="markdown"><p>A continuation function. Registered on the operation future and called when operations succeeds.</p></div></div></div></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L75">view source</a></div></div><div class="public anchor" id="var-create"><h3>create</h3><div class="usage"><code>(create db index set-name data expiration)</code><code>(create db index set-name data expiration conf)</code></div><div class="doc"><div class="markdown"><p><code>put</code> with a create-only policy</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L338">view source</a></div></div><div class="public anchor" id="var-create-client"><h3>create-client</h3><div class="usage"><code>(create-client hosts client-policy)</code></div><div class="doc"><div class="markdown"><p>Returns the Java <code>AerospikeClient</code> instance. To build the Clojure <code>IAerospikeClient</code> one, use <code>init-simple-aerospike-client</code>.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L36">view source</a></div></div><div class="public anchor" id="var-create-event-loops"><h3>create-event-loops</h3><div class="usage"><code>(create-event-loops conf)</code></div><div class="doc"><div class="markdown"><p>Called internally to create the event loops of for the client. Can also be used to share event loops between several clients.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L44">view source</a></div></div><div class="public anchor" id="var-delete"><h3>delete</h3><div class="usage"><code>(delete db index set-name)</code><code>(delete db index set-name conf)</code></div><div class="doc"><div class="markdown"><p>Delete the record stored for key <index>. Returns async true/false for deletion success (hit).</index></p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L402">view source</a></div></div><div class="public anchor" id="var-delete-bins"><h3>delete-bins</h3><div class="usage"><code>(delete-bins db index set-name bin-names new-expiration)</code><code>(delete-bins db index set-name bin-names new-expiration conf)</code></div><div class="doc"><div class="markdown"><p>Delete bins from an existing record. The <code>bin-names</code> must be a vector of strings.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L430">view source</a></div></div><div class="public anchor" id="var-EPOCH"><h3>EPOCH</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L14">view source</a></div></div><div class="public anchor" id="var-exists.3F"><h3>exists?</h3><div class="usage"><code>(exists? db index set-name)</code><code>(exists? db index set-name conf)</code></div><div class="doc"><div class="markdown"><p>Test if an index exists.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L266">view source</a></div></div><div class="public anchor" id="var-expiry-unix"><h3>expiry-unix</h3><div class="usage"><code>(expiry-unix ttl)</code></div><div class="doc"><div class="markdown"><p>Used to convert Aerospike style returned TTLS to standard UNIX EPOCH.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L499">view source</a></div></div><div class="public anchor" id="var-get-batch"><h3>get-batch</h3><div class="usage"><code>(get-batch db batch-reads)</code><code>(get-batch db batch-reads conf)</code></div><div class="doc"><div class="markdown"><p>Get a batch of records from the cluster asynchronously. <code>batch-reads</code> is a collection of maps of the form <code>{:index "foo" :set "someset" :bins [...]}</code> the <code>:bins</code> key can have required bins for the batched keys or missing/[:all] to get all the bins (see <code>_get</code>). The result is a vector of <code>AerospikeRecord</code>s in the same order of keys. Missing keys result in <code>nil</code> in corresponding positions.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L228">view source</a></div></div><div class="public anchor" id="var-get-cluster-stats"><h3>get-cluster-stats</h3><div class="usage"><code>(get-cluster-stats db)</code></div><div class="doc"><div class="markdown"><p>For each client, return a vector of [metric-name metric-val] 2-tuples. The metric name is a dot separated string that should be convenient for reporting to statsd/graphite. All values are gauges.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L465">view source</a></div></div><div class="public anchor" id="var-get-multiple"><h3>get-multiple</h3><h4 class="deprecated">deprecated in 0.3.2</h4><div class="usage"><code>(get-multiple db indices sets)</code><code>(get-multiple db indices sets conf)</code></div><div class="doc"><div class="markdown"><p>DEPRECATED - use <code>get-batch</code> instead.</p>
<p>Returns a (future) sequence of AerospikeRecords returned by <code>get-single</code> with records in corresponding places to the required keys. Indices and sets should be sequences. The <code>conf</code> map is passed to all <code>get-single</code> invocations.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L252">view source</a></div></div><div class="public anchor" id="var-get-single"><h3>get-single</h3><div class="usage"><code>(get-single db index set-name)</code><code>(get-single db index set-name conf)</code><code>(get-single db index set-name conf bin-names)</code></div><div class="doc"><div class="markdown"><p>Returns a single record: <code>(transcoder AerospikeRecord)</code>. The default transcoder is <code>identity</code>. Pass a <code>:policy</code> in <code>conf</code> to use a non-default <code>ReadPolicy</code></p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L214">view source</a></div></div><div class="public anchor" id="var-get-single-no-meta"><h3>get-single-no-meta</h3><div class="usage"><code>(get-single-no-meta db index set-name)</code><code>(get-single-no-meta db index set-name bin-names)</code></div><div class="doc"><div class="markdown"><p>Shorthand to return a single record payload only.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L280">view source</a></div></div><div class="public anchor" id="var-healthy.3F"><h3>healthy?</h3><div class="usage"><code>(healthy? db operation-timeout-ms)</code></div><div class="doc"><div class="markdown"><p>Returns true iff the cluster is reachable and can take reads and writes. Uses __health-check set to avoid data collisions. <code>operation-timeout-ms</code> is for total timeout of reads (including 2 retries) so an small over estimation is advised to avoid false negatives.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L477">view source</a></div></div><div class="public anchor" id="var-IAerospikeClient"><h3>IAerospikeClient</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-get-all-clients"><h3>get-all-clients</h3><div class="usage"><code>(get-all-clients _)</code></div><div class="doc"><div class="markdown"><p>Returns a sequence of all AerospikeClient objects.</p></div></div></div><div class="public anchor" id="var-get-client"><h3>get-client</h3><div class="usage"><code>(get-client ac)</code><code>(get-client ac index)</code></div><div class="doc"><div class="markdown"><p>Returns the relevant AerospikeClient object for the specific shard</p></div></div></div></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L22">view source</a></div></div><div class="public anchor" id="var-init-simple-aerospike-client"><h3>init-simple-aerospike-client</h3><div class="usage"><code>(init-simple-aerospike-client hosts aero-ns)</code><code>(init-simple-aerospike-client hosts aero-ns conf)</code></div><div class="doc"><div class="markdown"><p>hosts should be a seq of known hosts to bootstrap from.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L51">view source</a></div></div><div class="public anchor" id="var-MAX_BIN_NAME_LENGTH"><h3>MAX_BIN_NAME_LENGTH</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L20">view source</a></div></div><div class="public anchor" id="var-MAX_KEY_LENGTH"><h3>MAX_KEY_LENGTH</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L18">view source</a></div></div><div class="public anchor" id="var-operate"><h3>operate</h3><div class="usage"><code>(operate db index set-name expiration operations)</code><code>(operate db index set-name expiration operations conf)</code></div><div class="doc"><div class="markdown"><p>Asynchronously perform multiple read/write operations on a single key in one batch call. This method registers the command with an event loop and returns. The event loop thread will process the command and send the results to the listener. <code>commands</code> is a sequence of Aerospike CDT operations.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L443">view source</a></div></div><div class="public anchor" id="var-put"><h3>put</h3><div class="usage"><code>(put db index set-name data expiration)</code><code>(put db index set-name data expiration conf)</code></div><div class="doc"><div class="markdown"><p>Writes <code>data</code> into a record with the key <code>index</code>, with the ttl of <code>expiration</code> seconds. <code>index</code> should be string. Pass a function in <code>(:trascoder conf)</code> to modify <code>data</code> before it is sent to the DB. Pass a <code>WritePolicy</code> in <code>(:policy conf)</code> to uses the non-default policy. When a Clojure map is provided for the <code>data</code> argument, a multiple bin record will be created. Each key-value pair in the map will be treated as a bin-name, bin-value pair. Bin-names must be strings. Bin-values can be any nested data structure.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L300">view source</a></div></div><div class="public anchor" id="var-put-multiple"><h3>put-multiple</h3><div class="usage"><code>(put-multiple db indices set-names payloads expirations)</code><code>(put-multiple db indices set-names payloads expirations conf)</code></div><div class="doc"><div class="markdown"><p>Put multiple payloads by invoking <code>put</code>. All arguments should be mutually corresponding sequences.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L316">view source</a></div></div><div class="public anchor" id="var-replace-only"><h3>replace-only</h3><div class="usage"><code>(replace-only db index set-name data expiration)</code><code>(replace-only db index set-name data expiration conf)</code></div><div class="doc"><div class="markdown"><p><code>put</code> with a replace-only policy</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L349">view source</a></div></div><div class="public anchor" id="var-set-single"><h3>set-single</h3><div class="usage"><code>(set-single db index set-name data expiration)</code><code>(set-single db index set-name data expiration conf)</code></div><div class="doc"><div class="markdown"><p><code>put</code> with a update policy</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L327">view source</a></div></div><div class="public anchor" id="var-stop-aerospike-client"><h3>stop-aerospike-client</h3><div class="usage"><code>(stop-aerospike-client db)</code></div><div class="doc"><div class="markdown"><p>gracefully stop a client, waiting until all async operations finish.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L66">view source</a></div></div><div class="public anchor" id="var-touch"><h3>touch</h3><div class="usage"><code>(touch db index set-name expiration)</code></div><div class="doc"><div class="markdown"><p>Updates the ttl of the record stored under at <code>index</code> to <code>expiration</code> seconds from now. Expects records to exist.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L386">view source</a></div></div><div class="public anchor" id="var-update"><h3>update</h3><div class="usage"><code>(update db index set-name new-record generation new-expiration)</code><code>(update db index set-name new-record generation new-expiration conf)</code></div><div class="doc"><div class="markdown"><p>Writing a new value for the key <code>index</code>. Generation: the expected modification count of the record (i.e. how many times was it modified before my current action). Pass a function in <code>(:trascoder conf)</code> to modify <code>data</code> before it is sent to the DB.</p></div></div><div class="src-link"><a href="http://github.com/AppsFlyer/aerospike-clj/blob/0.3.6/src/aerospike_clj/client.clj#L360">view source</a></div></div></div></body></html>